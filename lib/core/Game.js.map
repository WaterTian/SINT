{"version":3,"sources":["../../src/core/Game.js"],"names":["PIXI","utils","skipHello","Game","config","loading","create","undefined","Object","assign","domElement","initWidth","initHeight","showFPS","backgroundColor","assets","width","height","settings","PRECISION_FRAGMENT","appendChild","view","stats","Stats","dom","vconsole","VConsole","SINT","TyLoader","loaders","Loader","key","add","onProgress","_e","progress","_this","load","loader","resources","console","log","init","window","addEventListener","resize","bind","ticker","animate","_c","offsetWidth","offsetHeight","style","transform","transformOrigin","renderer","render","child","stage","addChild","removeChild","delta","update","name","loop","_sound","sound","play","destroy","domBtns","document","getElementsByTagName","i","length","domBtn","title","body","removeAll","resource","tex","texture","texs","textures","Application"],"mappings":"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","file":"Game.js","sourcesContent":["import * as PIXI from 'pixi.js';\r\nimport 'pixi-sound';\r\nimport Stats from 'stats.js';\r\nimport VConsole from 'vconsole';\r\n\r\n\r\n\r\n\r\nPIXI.utils.skipHello();\r\n\r\n/**\r\n * @class\r\n * @extends PIXI.Application\r\n * \r\n * @param {object} config The Game options\r\n * @param {domElement} [config.domElement] \r\n * @param {string} [config.initWidth] The Game width\r\n * @param {string} [config.initHeight] The Game height\r\n * @param {boolean} [config.showFPS]\r\n */\r\n\r\nexport default class Game extends PIXI.Application {\r\n\r\n\tconstructor(config, loading, create) {\r\n\t\tif (config === undefined) {\r\n\t\t\tconfig = {}\r\n\t\t};\r\n\r\n\t\tconfig = Object.assign({\r\n\t\t\tdomElement: null,\r\n\t\t\tinitWidth: 750,\r\n\t\t\tinitHeight: 1334,\r\n\t\t\tshowFPS: true, // 显示帧频\r\n\t\t\tbackgroundColor: 0x000000, // 画布背景色\r\n\t\t\tassets: {},\r\n\t\t}, config);\r\n\r\n\r\n\t\tsuper({\r\n\t\t\twidth: config.initWidth,\r\n\t\t\theight: config.initHeight,\r\n\t\t\tbackgroundColor: config.backgroundColor,\r\n\t\t});\r\n\r\n\t\tPIXI.settings.PRECISION_FRAGMENT = 'highp';\r\n\r\n\r\n\t\tthis.domElement = config.domElement;\r\n\t\tthis.initWidth = config.initWidth;\r\n\t\tthis.initHeight = config.initHeight;\r\n\r\n\t\tthis.domElement.appendChild(this.view);\r\n\r\n\r\n\t\tif (config.showFPS) {\r\n\t\t\tthis.stats = new Stats();\r\n\t\t\tthis.domElement.appendChild(this.stats.dom);\r\n\t\t\tthis.vconsole = new VConsole();\r\n\t\t}\r\n\r\n\r\n\t\t/// assets load\r\n\t\tSINT.TyLoader = new PIXI.loaders.Loader();\r\n\t\tfor (let key in config.assets) {\r\n\t\t\tSINT.TyLoader.add(key, config.assets[key]);\r\n\t\t}\r\n\t\tSINT.TyLoader.onProgress.add((_e) => {\r\n\t\t\t// console.log(\"onProgress \" + _e.progress);\r\n\t\t\tif (loading) loading(_e.progress);\r\n\t\t});\r\n\r\n\t\tlet _this = this;\r\n\t\tSINT.TyLoader.load((loader, resources) => {\r\n\t\t\tconsole.log(\"loadComplete\");\r\n\t\t\tif (create) create();\r\n\t\t});\r\n\r\n\r\n\t\tthis.init();\r\n\t}\r\n\r\n\r\n\tinit() {\r\n\t\tconst {\r\n\t\t\tinitWidth,\r\n\t\t\tinitHeight\r\n\t\t} = this;\r\n\r\n\t\t// Handle window resize event\r\n\t\twindow.addEventListener('resize', this.resize.bind(this));\r\n\t\tthis.resize();\r\n\r\n\t\t// Handle fish animation\r\n\t\tthis.ticker.add(this.animate, this);\r\n\t}\r\n\r\n\tresize() {\r\n\r\n\t\tlet _c = this.domElement.offsetWidth / this.initWidth;\r\n\t\tconsole.log(\"resize \" + _c);\r\n\r\n\t\t// for bottom render bug\r\n\t\tthis.initHeight = this.domElement.offsetHeight / _c;\r\n\r\n\t\tthis.view.style.transform = \"matrix(\" + _c + \", 0, 0, \" + _c + \", 0, 0)\";\r\n\t\tthis.view.style.transformOrigin = \"0% 0%\";\r\n\r\n\t\tthis.renderer.resize(this.initWidth, this.initHeight);\r\n\t\tthis.render();\r\n\t}\r\n\r\n\t/**\r\n\t * Adds one or more children to the stage.\r\n\t *\r\n\t * @param {...PIXI.DisplayObject} child - The DisplayObject(s) to add to the container\r\n\t * @return {PIXI.DisplayObject} The first child that was added.\r\n\t */\r\n\tadd(child) {\r\n\t\tthis.stage.addChild(child);\r\n\t\treturn child;\r\n\t}\r\n\r\n\t/**\r\n\t * Remove child from stage.\r\n\t *\r\n\t * @param {...PIXI.DisplayObject} child - The DisplayObject(s) to add to the container\r\n\t */\r\n\tremove(child) {\r\n\t\tthis.stage.removeChild(child);\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Animate\r\n\t * @param {number} delta - % difference in time from last frame render\r\n\t */\r\n\tanimate(delta) {\r\n\r\n\t\tif (this.stats) this.stats.update();\r\n\r\n\r\n\t\t// this.animateTimer += delta;\r\n\t\t// const { animateTimer} = this;\r\n\t\t// this.events.emit('animate', delta, animateTimer);\r\n\t\t// if (!this.animating) {\r\n\t\t//     return;\r\n\t\t// }\r\n\t}\r\n\r\n\t/**\r\n\t * must be loaded\r\n\t * @param {String} name - sound name\r\n\t *\r\n\t * PIXI.sound.pause(name);\r\n\t * PIXI.sound.pauseAll();\r\n\t * \r\n\t * PIXI.sound.remove(name);\r\n\t * PIXI.sound.removeAll();\r\n\t * \r\n\t * PIXI.sound.stop(name);\r\n\t * PIXI.sound.stopAll();\r\n\t * \r\n\t * PIXI.sound.volume(name, volume);\r\n\t */\r\n\tplaySound(name, loop = false) {\r\n\t\tconst _sound = SINT.TyLoader.resources[name].sound;\r\n\t\t_sound.loop = loop;\r\n\t\t_sound.play();\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Destroy and don't use after this.\r\n\t */\r\n\tremoveThis() {\r\n\t\tif (this.stats) this.domElement.removeChild(this.stats.dom);\r\n\t\tif (this.vconsole) this.vconsole.destroy();\r\n\r\n\t\tconsole.log('removeThis');\r\n\r\n\r\n\t\t////Hook \r\n\t\tlet domBtns = document.getElementsByTagName(\"button\");\r\n\t\tfor (let i = 0; i < domBtns.length; i++) {\r\n\t\t\tlet domBtn = domBtns[i];\r\n\t\t\t// console.log(domBtn);\r\n\t\t\tif (domBtn.title = 'HOOK DIV') {\r\n\t\t\t\tdocument.body.removeChild(domBtn);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\r\n\t\tthis.destroy(true);\r\n\r\n\r\n\r\n\t\tPIXI.sound.removeAll();\r\n\r\n\t\t// console.log(SINT.TyLoader.resources);\r\n\r\n\t\tfor (let key in SINT.TyLoader.resources) {\r\n\t\t\tlet resource = SINT.TyLoader.resources[key];\r\n\t\t\t// console.log(resource);\r\n\t\t\tlet tex = resource.texture;\r\n\t\t\tif (tex) tex.destroy(true);\r\n\t\t\tlet texs = resource.textures;\r\n\t\t\tif (texs) {\r\n\t\t\t\tfor (let key in texs) {\r\n\t\t\t\t\ttexs[key].destroy(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tSINT.TyLoader.destroy();\r\n\t\t// SINT.TyLoader.removeAllListeners();\r\n\t\t// SINT.TyLoader.reset();\r\n\t\t// console.log(SINT.TyLoader.resources);\r\n\t}\r\n\r\n\r\n\r\n}"]}